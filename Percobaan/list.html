 <!DOCTYPE html>
<html>
<head>
<script src="http://maps.google.com/maps/api/js" 
          type="text/javascript"></script>
</head>
<body>
<script>
xmlhttp=new XMLHttpRequest();
xmlhttp.open("GET","map.xml",false);
xmlhttp.send();
xmlDoc=xmlhttp.responseXML;

function Neighbor(vnum, nbr){
    this.vertexNum = vnum;
    this.next = nbr;
}

function Node(id, neighbors){
    this.id = id;
    this.adjList = neighbors;
}

function isHighway(way,index){
	var tag = way[index].getElementsByTagName("tag");
	for (hg=0;hg<tag.length;hg++)
	{
		if(tag[hg].getAttribute('k') == "highway"){
			return true;
		}
	}
	return false;
}

function indexForName(adjLists,id) {
		for (var i=0; i < adjLists.length; i++){
			if (adjLists[i].id == id){
				return i;
			}
		}
		return -1;
	}

function Graph(node,way){
	var adjLists = [];
	var nd;
	
	for(v=0; v < node.length; v++){
		adjLists.push(new Node(node[v].getAttribute('id'),null));
	}
	
	for (i=0;i<way.length;i++)
	{
		nd = way[i].getElementsByTagName("nd");
		if(isHighway(way,i)){
			for (j=0;j<nd.length-1;j++)
			{
				v1 = indexForName(adjLists,nd[j].getAttribute('ref'));
				v2 = indexForName(adjLists,nd[j+1].getAttribute('ref'));

				adjLists[v1].adjList = new Neighbor(v2, adjLists[v1].adjList);
				adjLists[v2].adjList = new Neighbor(v1, adjLists[v2].adjList);
			}
		}
	}	
	return adjLists;
}

var node = xmlDoc.getElementsByTagName("node");
var way = xmlDoc.getElementsByTagName("way");

var list = new Graph(node,way);

for (j=0; j < list.length; j++){
	document.write(j);
	document.write("-->");
	document.write(list[j].id);
	for (nbr=list[j].adjList; nbr != null;nbr=nbr.next) {
		document.write("---->");
		document.write(list[nbr.vertexNum].id);
	}
	document.write("<br>");
}

</script>
</body>

</html> 